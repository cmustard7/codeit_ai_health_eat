
// íŒŒì¼ ì•„ì´ì½˜ ë° íƒ€ì… ê²°ì • í•¨ìˆ˜
  function getFileInfo(extname) {
    switch(extname.toLowerCase()) {
      case '.ipynb':
        return { icon: 'ğŸ““', type: 'Jupyter Notebook' };
      case '.py':
        return { icon: 'ğŸ', type: 'Python íŒŒì¼' };
      case '.md':
        return { icon: 'ğŸ“', type: 'Markdown ë¬¸ì„œ' };
      case '.json':
        return { icon: 'âš™ï¸', type: 'JSON ì„¤ì •' };
      case '.zip':
        return { icon: 'ğŸ“¦', type: 'ì••ì¶• íŒŒì¼' };
      case '.png':
      case '.jpg':
      case '.jpeg':
        return { icon: 'ğŸ–¼ï¸', type: 'ì´ë¯¸ì§€ íŒŒì¼' };
      case '.csv':
        return { icon: 'ğŸ“Š', type: 'ë°ì´í„° íŒŒì¼' };
      case '.pdf':
        return { icon: 'ğŸ“„', type: 'PDF ë¬¸ì„œ' };
      case '.docx':
        return { icon: 'ğŸ“', type: 'Word ë¬¸ì„œ' };
      case '.pptx':
        return { icon: 'ğŸ“Š', type: 'PowerPoint ë¬¸ì„œ' };
      case '.xlsx':
        return { icon: 'ğŸ“ˆ', type: 'Excel ë¬¸ì„œ' };
      case '.hwp':
        return { icon: 'ğŸ“„', type: 'HWP ë¬¸ì„œ' };
      default:
        return { icon: 'ğŸ“„', type: 'íŒŒì¼' };
    }
  }

  // ì˜¨ë¼ì¸ ë·°ì–´ë¡œ íŒŒì¼ ë³´ê¸° í•¨ìˆ˜
  function openGoogleSheetsViewer(fileName) {
    const githubRawUrl = `${raw_url}${fileName}`;
    // Google Sheets Import ê¸°ëŠ¥ ì‚¬ìš©
    const googleSheetsUrl = `https://docs.google.com/spreadsheets/d/e/2PACX-1vT7fUCH9Z_pX8K2vJ7Z3uE4fUCH9Z_pX8K2vJ7Z3uE4/pubhtml?embedded=true&url=${encodeURIComponent(githubRawUrl)}`;
    window.open(googleSheetsUrl, '_blank');
  }

  // CSV ë·°ì–´ í•¨ìˆ˜
  function openCSVViewer(fileName) {
    const modal = createViewerModal(`CSV ë·°ì–´ - ${fileName}`);
    const content = modal.querySelector('.viewer-content');
    
    fetch(`${raw_url}${fileName}`)
      .then(response => response.text())
      .then(data => {
        const rows = data.split('\n').map(row => row.split(','));
        let html = '<table border="1" style="border-collapse: collapse; width: 100%;">';
        rows.forEach((row, index) => {
          html += '<tr>';
          row.forEach(cell => {
            const tag = index === 0 ? 'th' : 'td';
            html += `<${tag} style="padding: 8px; border: 1px solid #ddd;">${cell.trim()}</${tag}>`;
          });
          html += '</tr>';
        });
        html += '</table>';
        content.innerHTML = html;
      })
      .catch(error => {
        content.innerHTML = `<p>CSV íŒŒì¼ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${error.message}</p>`;
      });
  }

  // JSON ë·°ì–´ í•¨ìˆ˜
  function openJSONViewer(fileName) {
    const modal = createViewerModal(`JSON ë·°ì–´ - ${fileName}`);
    const content = modal.querySelector('.viewer-content');
    
    fetch(`${raw_url}${fileName}`)
      .then(response => response.json())
      .then(data => {
        content.innerHTML = `<pre style="background: #f5f5f5; padding: 20px; border-radius: 5px; overflow: auto;">${JSON.stringify(data, null, 2)}</pre>`;
      })
      .catch(error => {
        content.innerHTML = `<p>JSON íŒŒì¼ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${error.message}</p>`;
      });
  }

  // ëª¨ë‹¬ ìƒì„± í•¨ìˆ˜
  function createViewerModal(title) {
    const modal = document.createElement('div');
    modal.style.cssText = `
      position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
      background: rgba(0,0,0,0.8); z-index: 1000; display: flex; 
      align-items: center; justify-content: center;
    `;
    
    modal.innerHTML = `
      <div style="background: white; width: 90%; height: 90%; border-radius: 10px; overflow: hidden;">
        <div style="background: #f0f0f0; padding: 15px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center;">
          <h3 style="margin: 0;">${title}</h3>
          <button onclick="this.closest('div[style*=\"position: fixed\"]').remove()" style="background: #ff5f56; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">Ã—</button>
        </div>
        <div class="viewer-content" style="padding: 20px; height: calc(100% - 70px); overflow: auto;">
          <p>ë¡œë”© ì¤‘...</p>
        </div>
      </div>
    `;
    
    document.body.appendChild(modal);
    return modal;
  }  

    // íŒŒì¼ ì•¡ì…˜ ë²„íŠ¼ ìƒì„± í•¨ìˆ˜
  function getFileActions(file) {
    const fileName = file.name;
    const fileExt = file.extname.toLowerCase();
    const githubRawUrl = `${raw_url}${fileName}`;
    
    let actions = '';
    
    // Markdown íŒŒì¼ ì²˜ë¦¬
    if (fileExt === '.md' && fileName !== 'index.md') {
      const mdName = fileName.replace('.md', '');
      actions += `<a href="${site_url}${mdName}" class="file-action" title="ë Œë”ë§ëœ í˜ì´ì§€ ë³´ê¸°">ğŸŒ</a>`;
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ì›ë³¸ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
    } 
    // Jupyter Notebook ì²˜ë¦¬
    else if (fileExt === '.ipynb') {
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
      actions += `<a href="${colab_url}${fileName}" class="file-action" title="Colabì—ì„œ ì—´ê¸°" target="_blank">ğŸš€</a>`;
      // NBViewer ì¶”ê°€
      actions += `<a href="https://nbviewer.org/github/${git_url.split('github.com/')[1].replace('/blob/', '/')}${fileName}" class="file-action" title="NBViewerë¡œ ë³´ê¸°" target="_blank">ğŸ“Š</a>`;
    } 
    // PDF íŒŒì¼ ì²˜ë¦¬
    else if (fileExt === '.pdf') {
      actions += `<a href="${site_url}${fileName}" class="file-action" title="ë Œë”ë§ëœ í˜ì´ì§€ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ë³´ê¸°" target="_blank">ğŸ“„</a>`;
      // PDF.js ë·°ì–´
      // actions += `<a href="https://mozilla.github.io/pdf.js/web/viewer.html?file=${encodeURIComponent(githubRawUrl)}" class="file-action" title="PDF ë·°ì–´ë¡œ ë³´ê¸°" target="_blank">ğŸ‘ï¸</a>`;
      // Google Docs Viewer (ë°±ì—…)
      // actions += `<a href="https://docs.google.com/viewer?url=${encodeURIComponent(githubRawUrl)}&embedded=true" class="file-action" title="Google ë·°ì–´ë¡œ ë³´ê¸°" target="_blank">ğŸ”</a>`;
    } 
    // Microsoft Office ë¬¸ì„œ (Word, PowerPoint)
    else if (fileExt === '.docx' || fileExt === '.pptx') {
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
    } 

    // Excel íŒŒì¼ ì²˜ë¦¬
    else if (fileExt === '.xlsx' || fileExt === '.xls') {
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
    }

    // CSV íŒŒì¼ ì²˜ë¦¬
    else if (fileExt === '.csv') {
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
      // CSV ë·°ì–´ (ë³„ë„ êµ¬í˜„)
      actions += `<a href="javascript:openCSVViewer('${fileName}')" class="file-action" title="CSV ë°ì´í„° ë³´ê¸°">ğŸ“Š</a>`;
    }
    // ì´ë¯¸ì§€ íŒŒì¼ ì²˜ë¦¬
    else if (['.png', '.jpg', '.jpeg', '.gif', '.svg'].includes(fileExt)) {
      actions += `<a href="${githubRawUrl}" class="file-action" title="ì´ë¯¸ì§€ ë³´ê¸°" target="_blank">ğŸ–¼ï¸</a>`;
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
    }
    // HWP íŒŒì¼ ì²˜ë¦¬
    else if (fileExt === '.hwp') {
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ë‹¤ìš´ë¡œë“œ" target="_blank">ğŸ“¥</a>`;
      actions += `<a href="javascript:alert('HWP íŒŒì¼ì€ ì˜¨ë¼ì¸ ë·°ì–´ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ìš´ë¡œë“œí•˜ì—¬ í™•ì¸í•´ì£¼ì„¸ìš”.')" class="file-action" title="ë·°ì–´ ì§€ì› ì•ˆí•¨">âŒ</a>`;
    }
    // HTML íŒŒì¼ ì²˜ë¦¬
    else if (fileExt === '.html') {
      actions += `<a href="${site_url}${fileName}" class="file-action" title="ì›¹í˜ì´ì§€ë¡œ ë³´ê¸°" target="_blank">ğŸŒ</a>`;
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ì›ë³¸ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
    }
    // JSON íŒŒì¼ ì²˜ë¦¬
    else if (fileExt === '.json') {
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
      actions += `<a href="javascript:openJSONViewer('${fileName}')" class="file-action" title="JSON ë·°ì–´ë¡œ ë³´ê¸°">âš™ï¸</a>`;
    }
    // ê¸°íƒ€ í…ìŠ¤íŠ¸ íŒŒì¼ (.py, .txt, .js, .css ë“±)
    else if (['.py', '.js', '.css', '.txt', '.xml', '.yaml', '.yml'].includes(fileExt)) {
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
      actions += `<a href="${githubRawUrl}" class="file-action" title="ì›ë³¸ í…ìŠ¤íŠ¸ ë³´ê¸°" target="_blank">ğŸ“„</a>`;
    }
    // ì••ì¶• íŒŒì¼
    else if (['.zip', '.rar', '.7z', '.tar', '.gz'].includes(fileExt)) {
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ë‹¤ìš´ë¡œë“œ" target="_blank">ğŸ“¥</a>`;
    }
    // ê¸°íƒ€ íŒŒì¼
    else {
      actions += `<a href="${git_url}${fileName}" class="file-action" title="GitHubì—ì„œ ì›ë³¸ ë³´ê¸°" target="_blank">ğŸ“–</a>`;
    }
    return actions;
  }

  // DOMì´ ë¡œë“œëœ í›„ íŒŒì¼ ëª©ë¡ ë Œë”ë§
  document.addEventListener('DOMContentLoaded', function() {
    const fileGrid = document.querySelector('.file-grid');
    
    if (curFiles.length === 0) {
      fileGrid.innerHTML = `
        <div class="empty-message">
          <span class="empty-icon">ğŸ“„</span>
          <h3>íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤</h3>
          <p>í˜„ì¬ ì´ ìœ„ì¹˜ì—ëŠ” ì™„ë£Œëœ ë¯¸ì…˜ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>
      `;
      return;
    }

    let html = '';
    curFiles.forEach(file => {
      if (file.name === 'index.md' || file.name === 'info.md') return;

      const fileInfo = getFileInfo(file.extname);
      const fileDate = file.modified_time ? new Date(file.modified_time).toLocaleDateString('ko-KR') : '';
      const actions = getFileActions(file);
      
      html += `
        <div class="file-item">
          <div class="file-icon">${fileInfo.icon}</div>
          <div class="file-info">
            <h4 class="file-name">${file.name}</h4>
            <p class="file-type">${fileInfo.type}</p>
            <p class="file-size">${fileDate}</p>
          </div>
          <div class="file-actions">
            ${actions}
          </div>
        </div>
      `;
    });
    
    fileGrid.innerHTML = html;
  });

/*
<h2>ï¿½ í•˜ìœ„ í´ë” ëª©ë¡</h2>
<div class="folder-grid">
</div>
*/
